{% comment %} 
        Search section aligned with site Tailwind style. 
        - Simple search form 
        - Shows product results (uses product-card snippet) when a search is performed 
        - Minimal settings: heading and placeholder 
{% endcomment %}

<section class="py-12">
  <div class="container mx-auto px-4">
    <div class="max-w-4xl mx-auto text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-900">{{ section.settings.heading }}</h1>
      {% if section.settings.subheading != blank %}
        <p class="text-gray-600 mt-2">{{ section.settings.subheading }}</p>
      {% endif %}
    </div>

    <form
      action="/search"
      method="get"
      class="max-w-3xl mx-auto flex gap-3">
      <input
        name="q"
        value="{{ search.terms | default: params.q }}"
        placeholder="{{ section.settings.placeholder }}"
        aria-label="Search"
        class="flex-1 px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-brandPrimary focus:border-transparent" />
      <input
        type="hidden"
        name="type"
        value="product" />
      <button type="submit" class="px-6 py-3 bg-brandPrimary text-white font-bold rounded-lg hover:opacity-95">
        Search
      </button>
    </form>

    {% if search.performed %}
      <div class="max-w-7xl mx-auto mt-10">
        <div class="flex items-center justify-between mb-6">
          <div class="text-sm text-gray-600">
            {% if section.settings.show_result_count %}
              Showing {{ search.results_count }} result{% if search.results_count != 1 %}s{% endif %}
              for
            {% endif %}
            <strong class="ml-1">&quot;{{ search.terms }}&quot;</strong>
          </div>
        </div>

        {% assign results_found = false %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {% for result in search.results %}
            {% if result.object_type == 'product' %}
              {% assign product_full = all_products[result.handle] %}
              {% render 'product-card',
                product: product_full,
                show_vendor: false,
                show_price: false,
                show_tags: false,
                show_certificate_badge: false,
                show_add_to_cart: false,
                section_id: section.id
              %}
            {% endif %}
          {% endfor %}

        </div>

        {% if search.results_count == 0 %}
          <div class="text-center py-12">
            <p class="text-gray-600">No products matched your search. Try different keywords.</p>
          </div>
        {% endif %}
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
  {
    "name": "t:general.search",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Search Products"
      }, {
        "type": "textarea",
        "id": "subheading",
        "label": "Subheading",
      }, {
        "type": "text",
        "id": "placeholder",
        "label": "Search placeholder",
        "default": "Search for products, SKUs, keywords..."
      }, {
        "type": "checkbox",
        "id": "show_result_count",
        "label": "Show result count",
        "default": true
      }

    ]
  }
{% endschema %}